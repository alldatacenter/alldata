Projection est. 100 rows
│     Expressions: [s_store_name], sum(ss_net_profit):=`expr#sum(ss_net_profit)`
└─ Limit est. 100 rows
   │     Limit: 100
   └─ Sorting est. ? rows
      │     Order by: {s_store_name asc}
      └─ Gather Exchange est. ? rows
         └─ Sorting est. ? rows
            │     Order by: {s_store_name asc}
            └─ MergingAggregated est. ? rows
               └─ Repartition Exchange est. ? rows
                  │     Partition by: {s_store_name}
                  └─ Aggregating est. ? rows
                     │     Group by: {s_store_name}
                     │     Aggregates: expr#sum(ss_net_profit):=AggNull(sum)(ss_net_profit)
                     └─ Inner Join est. ? rows
                        │     Condition: substring(s_zip, 1, 2) == substring(expr#substring(ca_zip, 1, 5)_2, 1, 2)
                        ├─ Repartition Exchange est. ? rows
                        │  │     Partition by: {substring(s_zip, 1, 2)}
                        │  └─ Projection est. ? rows
                        │     │     Expressions: [s_store_name, ss_net_profit], substring(s_zip, 1, 2):=substring(s_zip, 1, 2)
                        │     └─ Inner Join est. ? rows
                        │        │     Condition: ss_store_sk == s_store_sk
                        │        ├─ Repartition Exchange est. ? rows
                        │        │  │     Partition by: {ss_store_sk}
                        │        │  └─ Inner Join est. ? rows
                        │        │     │     Condition: ss_sold_date_sk == d_date_sk
                        │        │     ├─ Repartition Exchange est. ? rows
                        │        │     │  │     Partition by: {ss_sold_date_sk}
                        │        │     │  └─ TableScan tpcds.store_sales est. ? rows
                        │        │     │           Outputs: [ss_net_profit, ss_sold_date_sk, ss_store_sk]
                        │        │     └─ Repartition Exchange est. ? rows
                        │        │        │     Partition by: {d_date_sk}
                        │        │        └─ Filter est. ? rows
                        │        │           │     Condition: (d_qoy = 2) AND (d_year = 1998)
                        │        │           └─ TableScan tpcds.date_dim est. ? rows
                        │        │                    Outputs: [d_date_sk, d_qoy, d_year]
                        │        └─ Repartition Exchange est. ? rows
                        │           │     Partition by: {s_store_sk}
                        │           └─ TableScan tpcds.store est. ? rows
                        │                    Outputs: [s_store_name, s_store_sk, s_zip]
                        └─ Repartition Exchange est. ? rows
                           │     Partition by: {substring(expr#substring(ca_zip, 1, 5)_2, 1, 2)}
                           └─ Projection est. ? rows
                              │     Expressions: substring(expr#substring(ca_zip, 1, 5)_2, 1, 2):=substring(`expr#substring(ca_zip, 1, 5)_2`, 1, 2)
                              └─ Filter est. ? rows
                                 │     Condition: (sum_1 >= 1) AND (sum >= 1)
                                 └─ MergingAggregated est. ? rows
                                    └─ Repartition Exchange est. ? rows
                                       │     Partition by: {expr#substring(ca_zip, 1, 5)_2}
                                       └─ Aggregating est. ? rows
                                          │     Group by: {expr#substring(ca_zip, 1, 5)_2}
                                          │     Aggregates: sum:=AggNull(sum)(marker), sum_1:=AggNull(sum)(marker_1)
                                          └─ Union est. ? rows
                                             ├─ Projection est. ? rows
                                             │  │     Expressions: expr#substring(ca_zip, 1, 5):=substring(ca_zip, 1, 5), marker:=1, marker_1:=0
                                             │  └─ Filter est. ? rows
                                             │     │     Condition: substring(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576')
                                             │     └─ TableScan tpcds.customer_address est. ? rows
                                             │              Outputs: [ca_zip]
                                             └─ Projection est. ? rows
                                                │     Expressions: expr#substring(ca_zip, 1, 5)_1:=substring(ca_zip_1, 1, 5), marker:=0, marker_1:=1
                                                └─ Filter est. ? rows
                                                   │     Condition: `expr#count()` > 10
                                                   └─ MergingAggregated est. ? rows
                                                      └─ Repartition Exchange est. ? rows
                                                         │     Partition by: {ca_zip_1}
                                                         └─ Aggregating est. ? rows
                                                            │     Group by: {ca_zip_1}
                                                            │     Aggregates: expr#count():=AggNull(count)()
                                                            └─ Inner Join est. ? rows
                                                               │     Condition: ca_address_sk_1 == c_current_addr_sk
                                                               ├─ Repartition Exchange est. ? rows
                                                               │  │     Partition by: {ca_address_sk_1}
                                                               │  └─ TableScan tpcds.customer_address est. ? rows
                                                               │           Outputs: ca_address_sk_1:=ca_address_sk, ca_zip_1:=ca_zip
                                                               └─ Repartition Exchange est. ? rows
                                                                  │     Partition by: {c_current_addr_sk}
                                                                  └─ Filter est. ? rows
                                                                     │     Condition: c_preferred_cust_flag = 'Y'
                                                                     └─ TableScan tpcds.customer est. ? rows
                                                                              Outputs: [c_current_addr_sk, c_preferred_cust_flag]
