/**
 *   Licensed to the Apache Software Foundation (ASF) under one
 *   or more contributor license agreements.  See the NOTICE file
 *   distributed with this work for additional information
 *   regarding copyright ownership.  The ASF licenses this file
 *   to you under the Apache License, Version 2.0 (the
 *   "License"); you may not use this file except in compliance
 *   with the License.  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *   Unless required by applicable law or agreed to in writing, software
 *   distributed under the License is distributed on an "AS IS" BASIS,
 *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *   See the License for the specific language governing permissions and
 *   limitations under the License.
 */

import {Component, OnInit} from "@angular/core";
import {TISService} from "../common/tis.service";
import {BasicFormComponent} from "../common/basic.form.component";
import {AppDesc} from "./addapp-pojo";
import {NzModalService} from "ng-zorro-antd/modal";
import {PluginsComponent} from "../common/plugins.component";
import {BasicDataXAddComponent} from "./datax.add.base";
import {ActivatedRoute, Router} from "@angular/router";
import {Descriptor, Item} from "../common/tis.plugin";
import {NzIconService} from "ng-zorro-antd/icon";

// tslint:disable-next-line:max-line-length
const ngZorroIconSqlserver = '<svg class="icon" width="200px" height="200.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#13227a" d="M215.846 671.657c54.004-35.684 107.171-74.018 165.288-102.444 60.464-26.253 120.071-47.82 182.395-70.003 60.822-22.361 122.782-40.591 185.705-56.6 62.935-15.947 126.791-28.496 191.238-37.383l-9.76 19.962c-14.888-24.35-34.334-45.821-56.344-64.332-22.02-18.564-46.653-34.11-72.414-47.6a497.77 497.77 0 0 0-19.584-9.685c-6.597-3.106-13.241-6.132-19.963-9.003a599.898 599.898 0 0 0-20.331-8.266 695.449 695.449 0 0 0-20.608-7.678c-27.652-9.841-55.948-18.185-84.619-25.233-28.659-7.003-57.794-12.756-86.917-16.841-3.636-0.498-7.247-0.97-10.797-1.349l-11.274-1.236a2146.98 2146.98 0 0 1-22.539-2.722c-15.023-1.862-30.02-4.012-44.999-6.311-29.939-4.727-59.814-10.263-89.313-17.815-7.368-1.917-14.71-3.951-22.012-6.155-7.301-2.205-14.569-4.561-21.728-7.285-7.159-2.713-14.259-5.65-21.132-9.179-3.424-1.788-6.796-3.715-10.028-5.926-1.614-1.111-3.196-2.288-4.697-3.616a27.685 27.685 0 0 1-2.167-2.143c-0.347-0.386-0.683-0.79-1.006-1.225a11.139 11.139 0 0 1-0.477-0.691l-0.232-0.388c-0.081-0.149-0.142-0.252-0.271-0.547a1.62 1.62 0 1 1 2.971-1.294c-0.026-0.083 0.031 0.018 0.078 0.066l0.166 0.193c0.121 0.135 0.257 0.276 0.4 0.415 0.286 0.279 0.601 0.555 0.932 0.822a23.997 23.997 0 0 0 2.122 1.519c1.484 0.962 3.066 1.832 4.69 2.633 3.253 1.602 6.669 2.955 10.136 4.177 6.931 2.464 14.076 4.447 21.288 6.168 14.442 3.405 29.1 6.078 43.857 8.208 29.503 4.34 59.261 7.279 89.071 9.662 14.902 1.23 29.833 2.21 44.766 3.183l22.415 1.309 11.216 0.625c3.95 0.212 7.823 0.513 11.665 0.833 15.366 1.279 30.547 3.217 45.704 5.485 15.153 2.25 30.215 5.067 45.224 8.19 29.998 6.318 59.705 14.396 88.786 24.637 7.262 2.579 14.496 5.261 21.674 8.104a633.708 633.708 0 0 1 21.366 9.004c7.068 3.145 14.1 6.396 21.039 9.854a530.944 530.944 0 0 1 20.593 10.872 434.182 434.182 0 0 1 39.592 24.811c12.771 8.993 25.085 18.719 36.728 29.26 23.299 21.032 43.896 45.489 59.789 72.911l10.27 17.718-20.028 2.244c-63.62 7.125-126.857 18.122-189.391 32.393-62.549 14.216-124.444 32.854-185.355 53.341-60.944 20.386-120.986 42.426-179.757 68.681-29.383 13.128-58.455 26.986-87.121 41.661-14.349 7.303-28.602 14.803-42.719 22.554-14.101 7.766-28.14 15.716-41.803 24.169l-0.029 0.018a1.623 1.623 0 0 1-1.749-2.732z"  /><path fill="#13227a" d="M209.963 677.652c20.688-16.411 40.803-33.515 59.903-51.661 19.143-18.088 37.364-37.122 54.246-57.217 8.426-10.058 16.51-20.385 24.139-31.006 7.608-10.626 14.793-21.563 21.103-32.862a183.354 183.354 0 0 0 4.47-8.515l0.506-1.056 0.557-1.205 0.991-2.27 1.889-4.479a313.186 313.186 0 0 0 3.579-9.053 301.38 301.38 0 0 0 3.343-9.108 325.21 325.21 0 0 0 5.77-18.427c1.738-6.176 3.177-12.413 4.475-18.649a227.377 227.377 0 0 0 3.041-18.802c0.772-6.281 1.302-12.572 1.521-18.859 0.115-3.143 0.151-6.285 0.117-9.42-0.01-3.136-0.095-6.268-0.254-9.392a192.937 192.937 0 0 0-1.856-18.635c-3.512-24.695-11.826-48.505-23.843-70.371-5.981-10.957-12.992-21.366-20.633-31.296-7.681-9.896-16.184-19.212-25.226-27.776a175.341 175.341 0 0 0-6.899-6.159l-1.733-1.436-1.576-1.252c0.077 0.06-0.885-0.679-0.535-0.417l-0.117-0.102-0.233-0.204-0.466-0.407-0.948-0.874-1.88-1.762-3.716-3.564a282.594 282.594 0 0 1-3.577-3.748c-2.395-2.494-4.61-5.203-6.828-7.915-4.306-5.549-8.327-11.507-11.268-18.321-1.43-3.413-2.653-7.043-3.015-10.975-0.187-1.948-0.123-4.001 0.423-5.963 0.294-0.976 0.716-1.918 1.291-2.729 0.559-0.808 1.319-1.497 2.181-1.788-0.704 1.638-0.39 3.185 0.184 4.521 0.554 1.347 1.395 2.552 2.299 3.71 1.866 2.293 4.085 4.373 6.421 6.364 4.685 3.976 9.759 7.672 14.905 11.32 2.526 1.876 5.178 3.629 7.736 5.496 1.294 0.917 2.601 1.824 3.917 2.721l3.889 2.773 3.523 2.455 1.247 0.924 1.1 0.842 2.118 1.674a198.672 198.672 0 0 1 8.03 6.844c10.402 9.296 19.787 19.517 28.375 30.409 8.616 10.868 16.206 22.564 22.811 34.816 6.636 12.24 11.99 25.197 16.188 38.51 4.164 13.33 6.91 27.101 8.338 40.964 2.73 27.772-0.331 55.83-8.101 82.046-1.896 6.572-4.157 13.016-6.587 19.364-2.426 6.352-5.143 12.571-8.058 18.671a308.25 308.25 0 0 1-4.513 9.065 325.117 325.117 0 0 1-4.848 8.863l-2.528 4.382-1.267 2.135-0.513 1.027-0.6 1.157c-1.605 3.046-3.298 5.961-5.037 8.852-6.976 11.521-14.706 22.418-22.84 32.979-8.137 10.557-16.735 20.716-25.658 30.556-35.729 39.361-76.427 73.677-119.473 104.235z"  /><path fill="#13227a" d="M690.811 462.863c-11.202-10.033-23.855-19.852-35.554-29.38-11.68-9.552-23.726-18.717-36.167-27.376-6.239-4.303-12.542-8.533-18.979-12.561a597.859 597.859 0 0 0-19.576-11.684c-26.471-14.997-54.155-28.04-82.668-39.175-28.453-11.315-57.758-20.741-87.595-28.368-29.823-7.76-27.023-23.895 4.021-18.259 31.023 5.783 61.779 13.468 91.98 23.226 30.136 9.932 59.694 21.938 88.283 36.152a624.38 624.38 0 0 1 21.287 11.007c7.038 3.795 14.057 7.649 20.979 11.689 13.88 8.018 27.484 16.59 40.701 25.777 13.191 9.221 25.917 19.161 37.968 29.873a391.554 391.554 0 0 1 17.569 16.581"  /><path fill="#13227a" d="M504.265 210.272c7.783 20.086 13.193 41.187 16.299 62.71 3.1 21.525 3.785 43.508 1.912 65.352a297.933 297.933 0 0 1-1.9 16.374 214.153 214.153 0 0 1-1.403 8.137 249.382 249.382 0 0 1-1.724 8.121c-2.505 10.788-5.811 21.432-10.021 31.704-4.19 10.278-9.157 20.225-14.752 29.741-5.613 9.508-11.797 18.612-18.305 27.395-6.501 8.792-13.396 17.21-20.378 25.483-7.015 8.273-14.046 16.353-21.409 24.36-14.654 15.997-30.276 31.101-46.621 45.297-16.339 14.21-33.456 27.443-51.069 39.884a713.556 713.556 0 0 1-26.824 18.032 1231.056 1231.056 0 0 1-13.691 8.56c-4.612 2.777-9.218 5.555-13.899 8.215l12.484-10.215c4.177-3.373 8.331-6.772 12.459-10.198a1921.952 1921.952 0 0 0 24.653-20.604c16.29-13.859 32.193-28.084 47.546-42.809a789.044 789.044 0 0 0 44.143-45.921c3.516-3.964 6.976-7.995 10.467-12.047 3.489-4.036 6.954-8.08 10.37-12.151 6.84-8.134 13.449-16.402 19.757-24.824 6.299-8.429 12.219-17.076 17.55-26.025 5.357-8.931 10.134-18.162 14.155-27.707 4.007-9.548 7.361-19.368 9.895-29.436a234.407 234.407 0 0 0 1.772-7.585c0.542-2.582 1.021-4.99 1.513-7.687a294.292 294.292 0 0 0 2.503-15.502c2.848-20.812 3.639-41.967 2.602-63.149-1.024-21.194-3.927-42.38-8.084-63.505zM654.02 238.096c0.518 2.054 0.892 4.13 1.276 6.211 0.327 2.083 0.623 4.175 0.888 6.277 0.492 4.202 0.758 8.433 0.847 12.671a159.8 159.8 0 0 1-1.553 25.397c-0.272 2.107-0.622 4.201-0.985 6.293l-0.568 3.133-0.146 0.783-0.037 0.196-0.048 0.217-0.089 0.377-0.355 1.51c-0.983 4.118-2.055 8.2-3.201 12.268a305.387 305.387 0 0 1-7.876 24.147c-6.003 15.864-13.405 31.254-22.155 45.773-8.718 14.542-18.58 28.298-29.112 41.369a580.201 580.201 0 0 1-16.155 19.239l-8.222 9.268-8.147 9.285c-5.462 6.183-10.864 12.463-16.47 18.629a647.404 647.404 0 0 1-8.477 9.225 474.458 474.458 0 0 1-8.775 9.014 324.52 324.52 0 0 1-38.248 32.636c-6.761 4.911-13.643 9.618-20.685 14.061a599.722 599.722 0 0 1-10.618 6.553c-3.593 2.097-7.168 4.209-10.821 6.199l9.5-8.051a724.68 724.68 0 0 0 9.454-8.048c6.244-5.421 12.45-10.848 18.486-16.427 12.113-11.12 23.596-22.724 34.324-35.011 10.743-12.269 20.933-25.157 31.472-37.996 2.617-3.221 5.307-6.392 7.984-9.578 2.676-3.174 5.42-6.377 8.074-9.454 5.335-6.216 10.599-12.472 15.667-18.857 10.133-12.769 19.664-25.921 28.028-39.733 8.354-13.812 15.638-28.22 21.504-43.251a291.694 291.694 0 0 0 7.984-22.877 337.49 337.49 0 0 0 3.316-11.68l0.398-1.5 0.1-0.375 0.1-0.34 0.219-0.725 0.86-2.906 1.649-5.834c2.136-7.801 4.107-15.67 5.84-23.667a524.034 524.034 0 0 0 2.471-12.092c0.412-2.032 0.794-4.076 1.145-6.13l1.157-6.199zM822.932 290.223c-3.896 19.357-10.441 38.246-19.119 56.222-8.687 17.978-19.675 34.894-32.108 50.501-12.437 15.627-26.202 30.026-40.509 43.656-7.143 6.636-14.486 13.05-22.189 19.208a221.19 221.19 0 0 1-11.889 8.92c-4.093 2.849-8.298 5.586-12.806 7.972 2.541-4.421 5.308-8.567 8.153-12.638 2.847-4.068 5.8-8.029 8.868-11.893 6.117-7.736 12.646-15.163 19.583-22.159 13.807-13.665 27.259-27.554 39.798-42.145 12.549-14.581 24.136-29.908 34.447-46.224a393.993 393.993 0 0 0 14.589-25.138c4.585-8.592 8.915-17.377 13.182-26.282z"  /><path fill="#13227a" d="M345.965 547.814c33.042-32.345 69.5-61.194 107.723-87.398 38.283-26.148 78.514-49.519 120.168-69.979 41.652-20.465 84.758-37.989 128.859-52.278 44.111-14.228 89.215-25.373 134.961-32.052-44.042 13.988-87.524 28.726-130.216 45.387a1606.714 1606.714 0 0 0-125.675 55.097 1600.647 1600.647 0 0 0-120.477 65.695c-39.289 23.588-77.555 48.94-115.343 75.528zM393.713 444.275a383.308 383.308 0 0 1 14.563-17.172c4.999-5.596 10.141-11.057 15.365-16.442 10.466-10.75 21.354-21.084 32.536-31.091 22.4-19.971 46.024-38.562 70.553-55.831a836.583 836.583 0 0 1 76.195-47.736c13.12-7.242 26.423-14.146 39.945-20.604 6.768-3.216 13.57-6.355 20.448-9.339a446.32 446.32 0 0 1 20.835-8.515 987.665 987.665 0 0 1-18.4 12.902l-18.481 12.625-36.948 24.996c-24.595 16.627-49.021 33.367-73.24 50.387a3321.594 3321.594 0 0 0-71.992 52.044c-11.912 8.828-23.761 17.766-35.621 26.754l-17.811 13.515a1597.439 1597.439 0 0 1-17.947 13.507zM394.681 318.676c1.843-3.003 3.827-5.863 5.873-8.676 2.037-2.817 4.156-5.553 6.308-8.26 4.318-5.397 8.851-10.586 13.516-15.641 9.362-10.074 19.302-19.556 29.712-28.485a363.39 363.39 0 0 1 32.68-25.008c5.703-3.84 11.517-7.531 17.503-10.982 3.002-1.715 6.025-3.397 9.116-4.987 3.085-1.597 6.214-3.131 9.461-4.503-2.156 2.79-4.425 5.426-6.72 8.021-2.288 2.605-4.634 5.128-6.985 7.641-4.72 5.001-9.559 9.832-14.452 14.583-9.814 9.467-19.885 18.567-30.198 27.384-10.311 8.819-20.847 17.371-31.695 25.625-5.44 4.109-10.947 8.157-16.598 12.07-2.835 1.947-5.68 3.887-8.595 5.762-2.906 1.879-5.851 3.734-8.926 5.456z"  /><path fill="#13227a" d="M377.385 198.376c7.314 10.42 13.067 21.728 18.192 33.278 2.505 5.8 4.857 11.673 6.954 17.642 0.531 1.49 1.042 2.987 1.542 4.489 0.529 1.601 1.014 2.927 1.52 4.539 0.979 3.108 1.859 6.175 2.617 9.317 3.056 12.519 4.389 25.521 3.754 38.388a123.34 123.34 0 0 1-2.46 19.107c-1.343 6.278-3.107 12.454-5.732 18.401-1.064-6.414-1.678-12.653-2.379-18.819a1281.01 1281.01 0 0 0-2.105-18.259c-1.469-12.039-3.251-23.862-5.484-35.695l-1.735-8.858c-0.27-1.405-0.624-3.078-0.93-4.478l-1.037-4.493c-1.406-5.988-2.791-12.004-4.25-18.017-2.814-12.069-5.852-24.104-8.467-36.542zM400.461 418.669c3.467 0.23 6.864 0.806 10.224 1.573 3.365 0.756 6.67 1.755 9.938 2.907 6.52 2.334 12.803 5.438 18.746 9.173 11.894 7.464 22.255 17.681 30.145 29.499 7.903 11.82 13.317 25.195 15.93 38.873 1.309 6.843 1.981 13.755 1.945 20.638-0.039 3.445-0.206 6.874-0.597 10.289-0.379 3.412-0.928 6.805-1.798 10.171-1.359-3.2-2.545-6.363-3.734-9.485l-3.545-9.241c-2.362-6.078-4.739-12.002-7.301-17.747-5.113-11.491-10.798-22.307-17.533-32.398-6.715-10.105-14.476-19.442-23.241-28.313-4.378-4.444-9.038-8.73-13.914-12.995-2.432-2.145-4.94-4.247-7.484-6.394-2.553-2.137-5.163-4.266-7.781-6.55zM213.98 674.63s-101.966 69.187-52.733 141.79c0 0 35.523 62.631 161.722 96.598 0 0 144.272 33.34 219.991 29.601 0 0 9.038-1.869-16.203-6.854 0 0-72.877-10.811-146.453-25.862-51.476-10.532-100.322-31.201-122.46-45.183 0 0-129.315-71.046-68.864-149.258 0 0 20.914-32.032 52.056-54.967"  /><path fill="#13227a" d="M535.012 942.074s48.847-108.205 75.021-251.542c0 0 17.688-104.204 0-192.57l19.944-7.041s19.941 83.071-3.116 230.147c0 0-20.753 119.558-82.45 220.829"  /><path fill="#13227a" d="M542.96 941.841s-1.385 0.233-3.722 0.233c-3.706 0-3.725-1.792-3.725-1.792M165.298 756.591s225.6-62.942 291.66-90.364c0 0 127.756-49.232 165.772-87.871v13.088s-109.256 83.509-222.27 112.177c0 0-131.71 39.884-235.163 59.205v-6.235z"  /><path fill="#13227a" d="M224.502 848.203s129.095-167.642 164.884-266.732l25.194-11.84S384.845 679.34 303.65 759.708c0 0-57.958 72.292-74.162 95.351l-4.986-6.856zM501.206 532.861s14.539 90.365-58.479 216.252c0 0-63.669 121.524-102.308 162.034h11.841s63.547-54.22 132.733-205.034c0 0 44.714-112.178 32.958-178.237l-16.745 4.985zM359.115 911.147s196.478-57.505 215.629-65.438v6.232c0 0.001-149.569 59.83-215.629 59.206z"  /><path fill="#13227a" d="M581.599 842.594s-136.481-18.072-211.889-88.495c0 0-83.509-62.943-50.167-143.337l-27.733 6.232s-20.566 76.654 39.262 129.626c-0.001 0 87.247 98.466 250.527 95.974zM414.58 567.138s28.667 115.293 199.425 145.207l8.726-3.74s-192.562-64.189-192.562-149.777l-15.589 8.31z"  /><path fill="#13227a" d="M235.098 855.059s199.9-66.06 244.919-86.626c0 0 82.264-26.798 142.714-66.059l-4.985 9.971s-56.089 38.639-150.815 75.407c0 0-100.336 41.755-236.819 72.915l4.986-5.608zM519.92 530.369s99.071 59.827 110.913 60.451v-4.363s-96.444-57.958-105.322-64.19l-5.591 8.102zM549.186 219.389s-55.458-79.146-70.416-150.815c0 0-206.281 68.553-194.44 105.322l25.76 12.556 4.154-1.961s-19.942-18.696 48.61-56.089c0 0 66.06-36.146 112.177-51.103 0 0 15.58 108.438 52.973 138.975l21.182 3.115z"  /><path fill="#13227a" d="M341.042 134.633l50.526 67.306 24.944 2.493-75.47-76.654z"  /><path fill="#13227a" d="M501.206 162.054s-160.164-11.217-153.309-34.276h8.102s136.751 26.976 145.207 25.552v8.724zM456.766 206.301s48.179-37.954 50.048-38.607l-3.116-5.64s-61.386 34.808-72.759 37.658c-11.374 2.851 25.827 6.589 25.827 6.589z"  /><path fill="#13227a" d="M215.846 671.657c54.004-35.684 107.171-74.018 165.288-102.444 60.464-26.253 120.071-47.82 182.395-70.003 60.822-22.361 122.782-40.591 185.705-56.6 62.935-15.947 126.791-28.496 191.238-37.383l-9.76 19.962c-14.888-24.35-34.334-45.821-56.344-64.332-22.02-18.564-46.653-34.11-72.414-47.6a497.77 497.77 0 0 0-19.584-9.685c-6.597-3.106-13.241-6.132-19.963-9.003a599.898 599.898 0 0 0-20.331-8.266 695.449 695.449 0 0 0-20.608-7.678c-27.652-9.841-55.948-18.185-84.619-25.233-28.659-7.003-57.794-12.756-86.917-16.841-3.636-0.498-7.247-0.97-10.797-1.349l-11.274-1.236a2146.98 2146.98 0 0 1-22.539-2.722c-15.023-1.862-30.02-4.012-44.999-6.311-29.939-4.727-59.814-10.263-89.313-17.815-7.368-1.917-14.71-3.951-22.012-6.155-7.301-2.205-14.569-4.561-21.728-7.285-7.159-2.713-14.259-5.65-21.132-9.179-3.424-1.788-6.796-3.715-10.028-5.926-1.614-1.111-3.196-2.288-4.697-3.616a27.685 27.685 0 0 1-2.167-2.143c-0.347-0.386-0.683-0.79-1.006-1.225a11.139 11.139 0 0 1-0.477-0.691l-0.232-0.388c-0.081-0.149-0.142-0.252-0.271-0.547a1.62 1.62 0 1 1 2.971-1.294c-0.026-0.083 0.031 0.018 0.078 0.066l0.166 0.193c0.121 0.135 0.257 0.276 0.4 0.415 0.286 0.279 0.601 0.555 0.932 0.822a23.997 23.997 0 0 0 2.122 1.519c1.484 0.962 3.066 1.832 4.69 2.633 3.253 1.602 6.669 2.955 10.136 4.177 6.931 2.464 14.076 4.447 21.288 6.168 14.442 3.405 29.1 6.078 43.857 8.208 29.503 4.34 59.261 7.279 89.071 9.662 14.902 1.23 29.833 2.21 44.766 3.183l22.415 1.309 11.216 0.625c3.95 0.212 7.823 0.513 11.665 0.833 15.366 1.279 30.547 3.217 45.704 5.485 15.153 2.25 30.215 5.067 45.224 8.19 29.998 6.318 59.705 14.396 88.786 24.637 7.262 2.579 14.496 5.261 21.674 8.104a633.708 633.708 0 0 1 21.366 9.004c7.068 3.145 14.1 6.396 21.039 9.854a530.944 530.944 0 0 1 20.593 10.872 434.182 434.182 0 0 1 39.592 24.811c12.771 8.993 25.085 18.719 36.728 29.26 23.299 21.032 43.896 45.489 59.789 72.911l10.27 17.718-20.028 2.244c-63.62 7.125-126.857 18.122-189.391 32.393-62.549 14.216-124.444 32.854-185.355 53.341-60.944 20.386-120.986 42.426-179.757 68.681-29.383 13.128-58.455 26.986-87.121 41.661-14.349 7.303-28.602 14.803-42.719 22.554-14.101 7.766-28.14 15.716-41.803 24.169l-0.029 0.018a1.623 1.623 0 0 1-1.749-2.732z"  /><path fill="#13227a" d="M209.963 677.652c41.157-33.063 79.92-69.152 113.493-109.449 8.364-10.084 16.385-20.433 23.952-31.061 7.543-10.635 14.661-21.577 20.888-32.849a181.168 181.168 0 0 0 4.4-8.473l1.057-2.271 0.956-2.286 1.811-4.49a309.195 309.195 0 0 0 3.422-9.077 297.476 297.476 0 0 0 3.198-9.113 337.505 337.505 0 0 0 5.489-18.396c1.652-6.155 2.99-12.367 4.214-18.561a224.385 224.385 0 0 0 2.809-18.658c0.702-6.223 1.173-12.449 1.331-18.663 0.085-3.106 0.092-6.209 0.031-9.306-0.033-3.095-0.14-6.185-0.318-9.267a189.717 189.717 0 0 0-1.964-18.362c-3.604-24.317-11.887-47.708-23.759-69.25-5.903-10.798-12.843-21.048-20.365-30.862-7.569-9.773-15.963-18.979-24.838-27.453a174.746 174.746 0 0 0-6.759-6.075l-1.686-1.406-1.482-1.188c0.106 0.081-1.082-0.831-0.637-0.496l-0.115-0.103-0.231-0.206-0.462-0.414-0.945-0.897-1.87-1.811-3.696-3.662-3.535-3.875c-2.375-2.572-4.537-5.397-6.716-8.212-4.201-5.783-8.093-12.021-10.82-19.185-1.318-3.587-2.418-7.409-2.595-11.542-0.101-2.046 0.081-4.204 0.753-6.241 0.363-1.011 0.828-1.993 1.505-2.808 0.654-0.811 1.506-1.478 2.423-1.709-0.584 1.762-0.026 3.268 0.639 4.522 0.68 1.271 1.639 2.372 2.629 3.432 2.051 2.092 4.394 3.979 6.841 5.796 4.9 3.625 10.104 7.044 15.353 10.458 2.564 1.773 5.27 3.408 7.849 5.198l3.958 2.594 3.911 2.675 3.442 2.293 1.311 0.968 1.13 0.863 2.166 1.703a202.806 202.806 0 0 1 8.169 6.928c10.57 9.387 20.062 19.719 28.763 30.734 8.736 10.982 16.397 22.838 23.08 35.25 6.721 12.396 12.093 25.551 16.321 39.05 4.184 13.521 6.898 27.496 8.289 41.545 2.614 28.153-0.677 56.531-8.782 82.9-1.97 6.613-4.333 13.083-6.848 19.452-2.511 6.374-5.327 12.602-8.339 18.702a306.657 306.657 0 0 1-4.658 9.061 327.575 327.575 0 0 1-5.004 8.84l-2.606 4.37-1.301 2.118-1.119 2.175c-1.632 3.072-3.347 5.995-5.107 8.893-7.058 11.548-14.855 22.44-23.054 32.993-8.199 10.549-16.86 20.686-25.844 30.5-17.956 19.641-37.226 37.955-57.332 55.201a801.43 801.43 0 0 1-62.796 48.463z"  /><path fill="#13227a" d="M690.811 462.863c-11.202-10.033-23.855-19.852-35.554-29.38-11.68-9.552-23.726-18.717-36.167-27.376-6.239-4.303-12.542-8.533-18.979-12.561a597.859 597.859 0 0 0-19.576-11.684c-26.471-14.997-54.155-28.04-82.668-39.175-28.453-11.315-57.758-20.741-87.595-28.368-29.823-7.76-27.023-23.895 4.021-18.259 31.023 5.783 61.779 13.468 91.98 23.226 30.136 9.932 59.694 21.938 88.283 36.152a624.38 624.38 0 0 1 21.287 11.007c7.038 3.795 14.057 7.649 20.979 11.689 13.88 8.018 27.484 16.59 40.701 25.777 13.191 9.221 25.917 19.161 37.968 29.873a391.554 391.554 0 0 1 17.569 16.581"  /><path fill="#13227a" d="M504.265 210.272c8.23 19.958 13.948 41.048 17.311 62.613a281.744 281.744 0 0 1 2.469 65.623 298.03 298.03 0 0 1-1.825 16.481c-0.375 2.582-0.886 5.504-1.393 8.193a245.919 245.919 0 0 1-1.716 8.188c-2.502 10.876-5.801 21.622-10.037 31.982-4.21 10.369-9.201 20.403-14.825 29.992-5.648 9.578-11.865 18.737-18.398 27.563-6.525 8.837-13.455 17.274-20.455 25.565-7.036 8.293-14.069 16.366-21.479 24.381-14.725 16.011-30.459 31.089-46.925 45.221-16.46 14.145-33.728 27.258-51.503 39.521a661.29 661.29 0 0 1-27.092 17.716 1221.997 1221.997 0 0 1-13.843 8.358c-4.669 2.697-9.327 5.403-14.073 7.968l24.617-20.859a2431.026 2431.026 0 0 0 24.386-20.923c16.127-14.034 31.881-28.382 47.111-43.169a828.927 828.927 0 0 0 43.838-45.999c3.495-3.96 6.938-7.99 10.421-12.042 3.481-4.033 6.939-8.071 10.345-12.135a573.112 573.112 0 0 0 19.681-24.744c6.273-8.385 12.16-16.977 17.458-25.855 5.328-8.86 10.081-18.002 14.081-27.457 3.982-9.458 7.342-19.177 9.879-29.155a230.665 230.665 0 0 0 1.778-7.52c0.546-2.57 1.021-4.922 1.525-7.631a295.142 295.142 0 0 0 2.579-15.396c2.967-20.684 3.939-41.738 3.158-62.878-0.768-21.152-3.362-42.347-7.073-63.602zM654.02 238.096c2.406 8.22 3.54 16.717 3.97 25.251 0.398 8.536 0.044 17.126-1.024 25.611-0.237 2.126-0.563 4.238-0.905 6.348l-0.531 3.162-0.138 0.789-0.033 0.198-0.05 0.225-0.088 0.378-0.35 1.511a310.785 310.785 0 0 1-3.186 12.34 307.855 307.855 0 0 1-7.864 24.303c-6.02 15.967-13.436 31.479-22.234 46.085-8.762 14.632-18.667 28.462-29.248 41.57a572.384 572.384 0 0 1-16.213 19.286l-8.241 9.245-8.168 9.25c-10.93 12.319-21.915 24.936-33.998 36.728a314.736 314.736 0 0 1-38.731 32.343 373.459 373.459 0 0 1-20.948 13.78 357.946 357.946 0 0 1-21.753 12.328c12.455-11.08 24.957-21.916 36.863-33.229 11.941-11.279 23.257-22.964 33.842-35.304 10.596-12.322 20.698-25.239 31.193-38.135 2.603-3.238 5.293-6.415 7.964-9.615 2.671-3.183 5.418-6.41 8.057-9.477 5.314-6.208 10.563-12.445 15.607-18.81 10.083-12.732 19.574-25.81 27.895-39.532 8.304-13.725 15.574-28.012 21.423-42.94a289.39 289.39 0 0 0 7.998-22.721 341.978 341.978 0 0 0 3.33-11.608l0.403-1.498 0.102-0.375 0.026-0.093c0.009-0.039 0.002 0.001 0.02-0.059l0.055-0.179 0.228-0.718 0.897-2.877 1.73-5.779c2.254-7.726 4.402-15.517 6.368-23.453 1.998-7.938 3.735-16.007 5.732-24.329zM822.932 290.223c-3.33 19.547-9.583 38.631-18.054 56.813-8.486 18.183-19.401 35.294-31.819 51.028-12.424 15.755-26.229 30.216-40.597 43.842-7.168 6.592-14.612 12.882-22.511 18.844-3.939 2.983-8.016 5.854-12.26 8.554-4.248 2.697-8.631 5.262-13.38 7.397 2.298-4.671 4.889-8.992 7.58-13.212a197.146 197.146 0 0 1 8.496-12.259c5.923-7.931 12.35-15.483 19.262-22.523 13.745-13.669 27.159-27.496 39.711-41.958 12.563-14.455 24.224-29.585 34.734-45.696 10.567-16.088 19.774-33.202 28.838-50.83z"  /><path fill="#13227a" d="M345.965 547.814a554.561 554.561 0 0 1 25.007-24.114c8.562-7.806 17.35-15.363 26.277-22.762 17.879-14.767 36.438-28.729 55.501-41.985 38.164-26.459 78.401-50.008 120.13-70.507 41.727-20.505 84.978-37.926 129.251-51.931 22.144-6.98 44.542-13.115 67.147-18.258 11.308-2.555 22.654-4.9 34.056-6.94a594.59 594.59 0 0 1 34.343-5.212l-32.763 11.264c-10.886 3.781-21.745 7.563-32.546 11.472-21.612 7.778-43.068 15.82-64.323 24.294-42.53 16.878-84.302 35.349-125.282 55.445-40.977 20.104-81.146 41.848-120.515 65.167-19.703 11.632-39.191 23.681-58.536 36.055-19.37 12.348-38.491 25.146-57.747 38.012zM393.713 444.275c9.035-12.098 18.943-23.434 29.211-34.426 10.293-10.968 21.066-21.47 32.155-31.625 22.229-20.251 45.81-38.995 70.375-56.296a759.91 759.91 0 0 1 76.561-47.41c13.221-7.112 26.646-13.838 40.313-20.063 6.844-3.096 13.723-6.107 20.693-8.933a383.03 383.03 0 0 1 21.133-7.977c-11.965 9.213-24.18 17.829-36.34 26.475-12.179 8.606-24.398 17.063-36.577 25.538-24.396 16.885-48.696 33.723-72.875 50.714a5613.08 5613.08 0 0 0-72.171 51.577l-36 26.22-18.112 13.153a989.284 989.284 0 0 1-18.366 13.053zM394.681 318.676c1.69-3.162 3.557-6.145 5.497-9.073 1.928-2.933 3.958-5.767 6.025-8.568 4.152-5.583 8.573-10.903 13.13-16.087 9.161-10.32 19.057-19.883 29.473-28.832 10.428-8.937 21.396-17.241 32.981-24.723a248.85 248.85 0 0 1 17.886-10.531c3.083-1.617 6.188-3.195 9.378-4.66 3.183-1.474 6.417-2.872 9.798-4.069-2.021 2.964-4.184 5.736-6.381 8.455-2.19 2.729-4.453 5.356-6.722 7.967a360.601 360.601 0 0 1-14.071 15.035c-9.607 9.7-19.605 18.857-29.898 27.669-10.304 8.8-20.885 17.27-31.935 25.277-5.548 3.979-11.166 7.897-16.984 11.624-2.919 1.854-5.854 3.696-8.877 5.454-3.01 1.766-6.073 3.497-9.3 5.062z"  /><path fill="#13227a" d="M377.385 198.376c7.893 10.171 13.98 21.39 19.39 32.877 2.634 5.773 5.105 11.629 7.288 17.595a208.038 208.038 0 0 1 1.603 4.488c0.557 1.625 1.058 2.91 1.593 4.547 1.024 3.13 1.943 6.208 2.726 9.374 3.157 12.603 4.434 25.751 3.541 38.719a112.472 112.472 0 0 1-3.022 19.212c-1.595 6.292-3.653 12.46-6.732 18.349-1.518-6.472-2.425-12.718-3.378-18.871l-2.668-18.153c-1.728-11.938-3.566-23.616-5.697-35.365l-1.626-8.801a186.252 186.252 0 0 0-0.857-4.471l-0.974-4.493-3.917-18.063c-2.531-12.133-5.235-24.257-7.27-36.944zM400.461 418.669c3.572-0.022 7.066 0.362 10.524 0.96 3.467 0.584 6.87 1.447 10.241 2.477a89.806 89.806 0 0 1 19.348 8.694c12.266 7.308 22.957 17.621 30.989 29.654 8.052 12.031 13.415 25.727 15.745 39.667 1.187 6.97 1.588 14.02 1.273 20.998-0.19 3.494-0.52 6.966-1.107 10.417-0.573 3.448-1.335 6.87-2.48 10.256-1.634-3.18-3.034-6.314-4.417-9.401l-4.055-9.112a633.294 633.294 0 0 0-7.974-17.387c-5.396-11.228-11.132-21.724-17.718-31.604-6.573-9.891-14.004-19.131-22.397-28.158a343.862 343.862 0 0 0-13.311-13.475c-2.33-2.267-4.739-4.505-7.182-6.824-2.453-2.305-4.965-4.626-7.479-7.162zM213.98 674.63s-101.966 69.187-52.733 141.79c0 0 35.523 62.631 161.722 96.598 0 0 144.272 33.34 219.991 29.601 0 0 9.038-1.869-16.203-6.854 0 0-72.877-10.811-146.453-25.862-51.476-10.532-100.322-31.201-122.46-45.183 0 0-129.315-71.046-68.864-149.258 0 0 20.914-32.032 52.056-54.967"  /><path fill="#13227a" d="M535.012 942.074s48.847-108.205 75.021-251.542c0 0 17.688-104.204 0-192.57l19.944-7.041s19.941 83.071-3.116 230.147c0 0-20.753 119.558-82.45 220.829"  /><path fill="#13227a" d="M542.96 941.841s-1.385 0.233-3.722 0.233c-3.706 0-3.725-1.792-3.725-1.792M165.298 756.591s225.6-62.942 291.66-90.364c0 0 127.756-49.232 165.772-87.871v13.088s-109.256 83.509-222.27 112.177c0 0-131.71 39.884-235.163 59.205v-6.235z"  /><path fill="#13227a" d="M224.502 848.203s129.095-167.642 164.884-266.732l25.194-11.84S384.845 679.34 303.65 759.708c0 0-57.958 72.292-74.162 95.351l-4.986-6.856zM501.206 532.861s14.539 90.365-58.479 216.252c0 0-63.669 121.524-102.308 162.034h11.841s63.547-54.22 132.733-205.034c0 0 44.714-112.178 32.958-178.237l-16.745 4.985zM359.115 911.147s196.478-57.505 215.629-65.438v6.232c0 0.001-149.569 59.83-215.629 59.206z"  /><path fill="#13227a" d="M581.599 842.594s-136.481-18.072-211.889-88.495c0 0-83.509-62.943-50.167-143.337l-27.733 6.232s-20.566 76.654 39.262 129.626c-0.001 0 87.247 98.466 250.527 95.974zM414.58 567.138s28.667 115.293 199.425 145.207l8.726-3.74s-192.562-64.189-192.562-149.777l-15.589 8.31z"  /><path fill="#13227a" d="M235.098 855.059s199.9-66.06 244.919-86.626c0 0 82.264-26.798 142.714-66.059l-4.985 9.971s-56.089 38.639-150.815 75.407c0 0-100.336 41.755-236.819 72.915l4.986-5.608zM519.92 530.369s99.071 59.827 110.913 60.451v-4.363s-96.444-57.958-105.322-64.19l-5.591 8.102zM549.186 219.389s-55.458-79.146-70.416-150.815c0 0-206.281 68.553-194.44 105.322l25.76 12.556 4.154-1.961s-19.942-18.696 48.61-56.089c0 0 66.06-36.146 112.177-51.103 0 0 15.58 108.438 52.973 138.975l21.182 3.115z"  /><path fill="#13227a" d="M341.042 134.633l50.526 67.306 24.944 2.493-75.47-76.654z"  /><path fill="#13227a" d="M501.206 162.054s-160.164-11.217-153.309-34.276h8.102s136.751 26.976 145.207 25.552v8.724zM456.766 206.301s48.179-37.954 50.048-38.607l-3.116-5.64s-61.386 34.808-72.759 37.658c-11.374 2.851 25.827 6.589 25.827 6.589z"  /></svg>'

// 文档：https://angular.io/docs/ts/latest/guide/forms.html
@Component({
  selector: 'addapp-form',
  // templateUrl: '/runtime/addapp.htm'
  template: `
      <tis-steps type="createDatax" [step]="0"></tis-steps>
      <!--      <tis-page-header [showBreadcrumb]="false" [result]="result">-->
      <!--          <tis-header-tool>-->
      <!--              <button nz-button nzType="primary" (click)="execNextStep()">下一步</button>-->
      <!--          </tis-header-tool>-->
      <!--      </tis-page-header>-->
      <nz-spin [nzSpinning]="this.formDisabled">
          <tis-steps-tools-bar [result]="this.result" [title]="'Reader & Writer类型'" (cancel)="cancel()" (goBack)="goback()" (goOn)="execNextStep()"></tis-steps-tools-bar>
          <tis-form [fieldsErr]="errorItem">
              <tis-ipt #readerType title="Reader类型" name="readerType" require="true">
                  <!--                  <nz-select nzSize="large" nzPlaceHolder="请选择" name="reader" class="form-control" [ngModel]="dto.readerImpl" (ngModelChange)="changeReaderDesc($event)">-->
                  <!--                      <nz-option *ngFor="let pp of readerDesc" [nzValue]="pp.impl" [nzLabel]="pp.displayName"></nz-option>-->
                  <!--                  </nz-select>-->

                  <nz-radio-group [ngModel]="dto.readerImpl" nzSize="large" (ngModelChange)="changeReaderDesc($event)" nzButtonStyle="solid">
                      <label class="source-lab" *ngFor="let pp of readerDesc" nz-radio-button [nzValue]="pp.impl">{{pp.displayName}}</label>
                  </nz-radio-group>
              </tis-ipt>
              <tis-ipt #writerType title="Writer类型" name="writerType" require="true">
                  <!--                  <nz-select nzSize="large" nzPlaceHolder="请选择" name="writer" class="form-control" [ngModel]="dto.writerImpl" (ngModelChange)="changeWriterDesc($event)">-->
                  <!--                      <nz-option *ngFor="let pp of writerDesc" [nzValue]="pp.impl" [nzLabel]="pp.displayName"></nz-option>-->
                  <!--                  </nz-select>-->


                  <nz-radio-group [ngModel]="dto.writerImpl" nzSize="large" (ngModelChange)="changeWriterDesc($event)" nzButtonStyle="solid">
                      <label class="source-lab" *ngFor="let pp of writerDesc" nz-radio-button [nzValue]="pp.impl">{{pp.displayName}}</label>
                  </nz-radio-group>
              </tis-ipt>
              <tis-ipt title="插件安装" require="false">
                  <tis-plugin-add-btn (afterPluginAddClose)="ngOnInit()" [extendPoint]="['com.qlangtech.tis.datax.impl.DataxReader','com.qlangtech.tis.datax.impl.DataxWriter']"
                                      [descriptors]="[]">添加<i nz-icon nzType="down"></i></tis-plugin-add-btn>
              </tis-ipt>
          </tis-form>
      </nz-spin>
<!--      <i nz-icon nzType="ng-zorro:sqlserver" style="font-size: 25px"></i>-->
      <!-- Content here -->
  `
  , styles: [
      `
            .source-lab {
                margin-top: 5px;
                margin-left: 5px;
            }
    `
  ]
})
export class DataxAddStep2Component extends BasicDataXAddComponent implements OnInit {
  errorItem: Item = Item.create([]);
  // model = new Application(
  //   '', 'Lucene6.0', -1, new Crontab(), -1, ''
  // );
  model = new AppDesc();


  // 可选的数据源
  readerDesc: Array<Descriptor> = [];
  writerDesc: Array<Descriptor> = [];

  public static getDataXReaderWriterEnum(baseForm: BasicFormComponent): Promise<DataXReaderWriterEnum> {
    return baseForm.httpPost('/coredefine/corenodemanage.ajax'
      , 'action=datax_action&emethod=get_supported_reader_writer_types')
      .then((r) => {
        if (r.success) {
          let rList = PluginsComponent.wrapDescriptors(r.bizresult.readerDesc);
          let wList = PluginsComponent.wrapDescriptors(r.bizresult.writerDesc);
          // this.readerDesc = Array.from(rList.values());
          // this.writerDesc = Array.from(wList.values());
          return {"readerDescs": Array.from(rList.values()), "writerDescs": Array.from(wList.values())};
        }
      });
  }


  constructor(tisService: TISService, modalService: NzModalService, r: Router, route: ActivatedRoute, private iconService: NzIconService) {
    super(tisService, modalService, r, route);
    this.iconService.addIconLiteral('ng-zorro:sqlserver', ngZorroIconSqlserver);
  }


  ngOnInit(): void {

    DataxAddStep2Component.getDataXReaderWriterEnum(this).then((rwEnum: DataXReaderWriterEnum) => {
      this.readerDesc = rwEnum.readerDescs;
      this.writerDesc = rwEnum.writerDescs;
    });
    //  return {"readerDescs": this.readerDesc, "writerDescs": this.writerDesc};
  }


// 执行下一步
  public execNextStep(): void {
    // let dto = new DataxDTO();
    // dto.appform = this.readerDesc;
    this.jsonPost('/coredefine/corenodemanage.ajax?action=datax_action&emethod=validate_reader_writer'
      , this.dto)
      .then((r) => {
        this.processResult(r);
        if (r.success) {
          this.dto.processMeta = r.bizresult;
          this.nextStep.emit(this.dto);
        } else {
          this.errorItem = Item.processFieldsErr(r);
        }
      });
  }


  changeReaderDesc(desIml: any): void {
    // console.log(event);
    this.readerDesc.forEach((desc) => {
      if (desc.impl === desIml) {
        this.dto.readerDescriptor = desc;
      }
    });
  }

  changeWriterDesc(desIml: any): void {
    this.writerDesc.forEach((desc) => {
      if (desc.impl === desIml) {
        this.dto.writerDescriptor = desc;
      }
    });
  }

}

export interface DataXReaderWriterEnum {
  readerDescs: Array<Descriptor>;
  writerDescs: Array<Descriptor>;
}
